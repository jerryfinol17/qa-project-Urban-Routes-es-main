Esta es la version final que pude realizar del codigo, se que es bastante extenso y robusto, porque me vali de la ayuda de la inteligencia artificial cuando no encontraba salida en alguna parte del codigo, y porque tengo unos problemas con los drivers, asi que debo hacer una linea de codigo especifica para ese problema, espero que el codigo sea funcional cuando lo revise, y si hay algo que deba corregir solo aviseme, creo que es bastante funcional y preciso, ejecute la prueba varias veces para verificar que todos los pasos se cumpliesen, y en mi percepcion fue asi, saludos y muchas gracias de antemano.

